##
## Copyright 2008 The qDecoder Project. All rights reserved.
##
## Redistribution and use in source and binary forms, with or without
## modification, are permitted provided that the following conditions
## are met:
##
## 1. Redistributions of source code must retain the above copyright
##    notice, this list of conditions and the following disclaimer.
## 2. Redistributions in binary form must reproduce the above copyright
##    notice, this list of conditions and the following disclaimer in the
##    documentation and/or other materials provided with the distribution.
##
## THIS SOFTWARE IS PROVIDED BY THE QDECODER PROJECT ``AS IS'' AND ANY
## EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
## WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
## DISCLAIMED. IN NO EVENT SHALL THE QDECODER PROJECT BE LIABLE FOR ANY
## DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
## (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
## LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
## ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
## (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
## THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
##

## Which compiler
CC	= @CC@
CFLAGS	= @CFLAGS@
DEFS	= @DEFS@
INCLUDE	= -I. -I../src

## qDecoder Library Path
QLIB	= ../src/libqDecoder.a
#QLIB	= ../src/libqDecoder.so

## Main
all:	query.cgi cookie.cgi multivalue.cgi upload.cgi uploadfile.cgi download.cgi streamedit.cgi session.cgi config.cgi socket.cgi obstack.cgi

query.cgi: ${QLIB} query.o
	${CC} ${CFLAGS} ${DEFS} ${INCLUDE} -o query.cgi query.o ${QLIB}

cookie.cgi: ${QLIB} cookie.o
	${CC} ${CFLAGS} ${DEFS} ${INCLUDE} -o cookie.cgi cookie.o ${QLIB}

multivalue.cgi:	${QLIB} multivalue.o
	${CC} ${CFLAGS} ${DEFS} ${INCLUDE} -o multivalue.cgi multivalue.o ${QLIB}

upload.cgi: ${QLIB} upload.o
	${CC} ${CFLAGS} ${DEFS} ${INCLUDE} -o upload.cgi upload.o ${QLIB}
	chmod 6755 upload.cgi

uploadfile.cgi: ${QLIB} uploadfile.o
	${CC} ${CFLAGS} ${DEFS} ${INCLUDE} -o uploadfile.cgi uploadfile.o ${QLIB}
	chmod 6755 uploadfile.cgi

download.cgi: ${QLIB} download.o
	${CC} ${CFLAGS} ${DEFS} ${INCLUDE} -o download.cgi download.o ${QLIB}

streamedit.cgi: ${QLIB} streamedit.o
	${CC} ${CFLAGS} ${DEFS} ${INCLUDE} -o streamedit.cgi streamedit.o ${QLIB}

session.cgi: ${QLIB} session.o
	${CC} ${CFLAGS} ${DEFS} ${INCLUDE} -o session.cgi session.o ${QLIB}
	chmod 6755 session.cgi

config.cgi: ${QLIB} config.o
	${CC} ${CFLAGS} ${DEFS} ${INCLUDE} -o config.cgi config.o ${QLIB}

socket.cgi: ${QLIB} socket.o
	${CC} ${CFLAGS} ${DEFS} ${INCLUDE} -o socket.cgi socket.o ${QLIB}

obstack.cgi: ${QLIB} obstack.o
	${CC} ${CFLAGS} ${DEFS} ${INCLUDE} -o obstack.cgi obstack.o ${QLIB}

${QLIB}:
	(cd ../src/; make all)

## Clear Module
clean:
	rm -rf *.o *.cgi upload/* tmp/*

## Compile Module
.c.o:
	${CC} ${CFLAGS} ${DEFS} ${INCLUDE} -c -o $@ $<
